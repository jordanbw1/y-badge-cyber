<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Issue Commands</title>
    <style>
        .error-message {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Issue Commands</h1>
    <form id="commandForm" method="post">
        <div>
            <label for="identifier">Identifier:</label>
            <input type="text" id="identifier" name="identifier" required>
        </div>
        <div>
            <label for="password">Password:</label>
            <input type="text" id="password" name="password" required>
        </div>
        <div>
            <label for="color">Color:</label>
            <input type="color" id="color" name="color">
        </div>
        <button type="submit">Send Command</button>
    </form>
    <div id="errorContainer" class="error-message"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var form = document.getElementById('commandForm');
            var submitBtn = document.getElementById('submitBtn');
            var errorContainer = document.getElementById('errorContainer');

            form.addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent default form submission

                // Clear previous error messages
                errorContainer.textContent = '';

                // Get form data
                var formData = new FormData(form);

                // Create XMLHttpRequest object
                var xhr = new XMLHttpRequest();

                // Define what happens on successful data submission
                xhr.onload = function () {
                    if (xhr.status === 200) {
                        // Handle success, if needed
                        console.log("Command submitted successfully");
                    } else {
                        // Handle error, if needed
                        console.log("Error occurred while submitting command");
                        // Handle error, display the error message
                        var response = JSON.parse(xhr.responseText);
                        errorContainer.textContent = response.error || 'An error occurred while submitting the command';
                    }
                };

                // Define what happens in case of error
                xhr.onerror = function () {
                    errorContainer.textContent = 'An error occurred while submitting the command';
                };

                // Open connection
                xhr.open('POST', form.action);

                // Send form data
                xhr.send(formData);
            });
        });
    </script>
</body>
</html>
